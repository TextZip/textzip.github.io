<!DOCTYPE html>
<html lang="en-US" 
>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Robotics Theory - 2D Robotics" />
<meta name="author" content="Jai Krishna" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction" />
<meta property="og:description" content="Introduction" />
<link rel="canonical" href="https://textzip.github.io/posts/Robotics-Theory-2D-Robotics/" />
<meta property="og:url" content="https://textzip.github.io/posts/Robotics-Theory-2D-Robotics/" />
<meta property="og:site_name" content="Jai Krishna" />
<meta property="og:image" content="https://textzip.github.io/assets/img/2DRobotics/ProjNoD.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-04T23:47:20+05:30" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://textzip.github.io/assets/img/2DRobotics/ProjNoD.png" />
<meta property="twitter:title" content="Robotics Theory - 2D Robotics" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="twitter:creator" content="@Jai Krishna" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jai Krishna"},"dateModified":"2022-01-18T20:14:23+05:30","datePublished":"2020-05-04T23:47:20+05:30","description":"Introduction","headline":"Robotics Theory - 2D Robotics","image":"https://textzip.github.io/assets/img/2DRobotics/ProjNoD.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://textzip.github.io/posts/Robotics-Theory-2D-Robotics/"},"url":"https://textzip.github.io/posts/Robotics-Theory-2D-Robotics/"}</script>
 <title>Robotics Theory - 2D Robotics | Jai Krishna
 </title>
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Jai Krishna">
<meta name="application-name" content="Jai Krishna">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials">
  <link rel="dns-prefetch" href="https://www.google-analytics.com">
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://www.googletagmanager.com">
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>
<script defer src="/assets/js/dist/post.min.js"></script>
  <script>
  /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
  MathJax = {
    tex: {
      inlineMath: [              /* start/end delimiter pairs for in-line math */
        ['$','$'],
        ['\\(','\\)']
      ],
      displayMath: [             /* start/end delimiter pairs for display math */
        ['$$', '$$'],
        ['\\[', '\\]']
      ]
    }
  };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <script defer src="/app.js"></script>
<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-KGYYX7MFB2"
></script>
<script>
  /* global dataLayer */
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "G-KGYYX7MFB2");
</script>
 <body data-spy="scroll" data-target="#toc">
<div id="sidebar" class="d-flex flex-column align-items-end">
 <div class="profile-wrapper text-center">
   <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
   </div>
   <div class="site-title mt-3">
      <a href="/">Jai Krishna</a>
   </div>
   <div class="site-subtitle font-italic">Robotics | Electronics | Design</div>
 </div>
 <ul class="w-100">
   <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
   <li class="nav-item">
      <a href="/projects/" class="nav-link">
        <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i>
        <span>PROJECTS</span>
      </a>
   <li class="nav-item">
      <a href="/resources/" class="nav-link">
        <i class="fa-fw fas fa-chalkboard-teacher ml-xl-3 mr-xl-3 unloaded"></i>
        <span>RESOURCES</span>
      </a>
   <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
   <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
   <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT | CONTACT</span>
      </a>
   <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-chalkboard-teacher ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
 </ul>
 <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">
      <a href="https://github.com/TextZip" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      <a href="
          javascript:location.href = 'mailto:' + ['textzip','gmail.com'].join('@')" aria-label="email"
        class="order-4"
        >
        <i class="fas fa-envelope"></i>
      </a>
      <a href="https://www.linkedin.com/in/jai-krishna-bandi" aria-label="linkedin"
        class="order-5"
        target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
        <span class="icon-border order-2"></span>
      <span id="mode-toggle-wrapper" class="order-1">
<i class="mode-toggle fas fa-adjust"></i>
<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }
      var self = this;
      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }
          self.clearMode();
        }
        self.updateMermaid();
      });
    } /* constructor() */
    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }
    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }
    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }
    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }
    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }
    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }
    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }
    get hasMode() { return this.mode != null; }
    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }
    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }
    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };
        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });
        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }
    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }
      this.updateMermaid();
    } /* flipMode() */
  } /* ModeToggle */
  let toggle = new ModeToggle();
  $(".mode-toggle").click(function() {
    toggle.flipMode();
  });
</script>
      </span>
 </div>
</div>
<div id="topbar-wrapper" class="row justify-content-center topbar-down">
 <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">
        <span>
          <a href="/">
            Posts
          </a>
        </span>
          <span>Robotics Theory - 2D Robotics</span>
    </span>
    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>
   <div id="topbar-title">
      Post
   </div>
    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
 </div>
</div>
   <div id="main-wrapper">
     <div id="main">
<div class="row">
 <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">
   <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
     <h1 data-toc-skip>Robotics Theory - 2D Robotics</h1>
     <div class="post-meta text-muted d-flex flex-column">
       <div>
          <span class="semi-bold">
            Bandi Jai Krishna
          </span>
<em class="timeago"
    data-ts="1588616240"
      data-toggle="tooltip" data-placement="bottom" 
      title="Mon, May  4, 2020, 11:47 PM +0530"
    >
  2020-05-04
</em>
       </div>
       <div>
          <span>
<em class="timeago lastmod"
    data-ts="1642517063"
      data-toggle="tooltip" data-placement="bottom" 
      title="Tue, Jan 18, 2022,  8:14 PM +0530"
    >
  2022-01-18
</em>
          </span>
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3945 words">21 min</span>
       </div>
     </div>
     <div class="post-content">
       <h2 id="introduction">Introduction</h2>
<h2 id="coordinate-transformation-in-2d">Coordinate Transformation in 2D</h2>
<p>The motion of manipulators and robots is often very complex and mathematically demanding. A single coordinate frame usually isn’t sufficient, and its often convenient to use multiple
coordinate frames (fixed or moving) to make things easier.</p>
<p><strong>Terminology</strong><br />
Fixed and World coordinate frames are used interchangeably and mean the same thing.<br />
Mobile and Moving coordinate frames are used interchangeably and mean the same thing.</p>
<h3 id="what-is-a-coordinate-frame-">What is a Coordinate Frame ?</h3>
<p>If $p$ is a vector in $R^n$ and $X = {x^1 , x^2 , …x^n}$ be a complete orthonormal set of $R^n$, then
coordinates of $p$ with respect to $X$ are denoted as $[p]^x$.</p>
\[\begin{aligned}
	p &amp;= \Sigma{[p]_k^x}\hat{x^k} \\
	[p]_k^x &amp;= p.x^k
\end{aligned}\]
<p><img src="/assets/img/2DRobotics_new/1_PFrame.png" alt="Image1" class="shadow" /></p>
<h3 id="translation">Translation</h3>
<p>Assume a fixed frame $(O_0 − X_0 − Y_0 )$ and a mobile frame $(O_1 − X_1 − Y_1 )$. Let $C$ be a point
in space. The relation between both the frames and $C$ can be derived using simple math.</p>
<p><img src="/assets/img/2DRobotics_new/2_Trans.png" alt="Image1" class="shadow" /></p>
<p>The following inferences can be made from the above figure:<br />
Position of C $\mathit{wrt}$ frame $(O_0-X_0-Y_0)$ can be represented as</p>
\[\begin{equation*}
	C^0 = \begin{bmatrix}
		X_C^0\\
		Y_C^0
	\end{bmatrix}
\end{equation*}\]
<p>Position of C $\textit{wrt}$ frame $(O_1-X_1-Y_1)$ can be represented as</p>
\[\begin{equation*}
	C^1 = \begin{bmatrix}
		X_C^1\\
		Y_C^1
	\end{bmatrix}
\end{equation*}\]
<p>Position of $O_1$ $\textit{wrt}$ frame $(O_0-X_0-Y_0)$ can be represented as</p>
\[\begin{equation*}
	O_1^0 = \begin{bmatrix}
		X_0\\
		Y_0
	\end{bmatrix}
\end{equation*}\]
<p>Position of $O_0$ $\textit{wrt}$ frame $(O_1-X_1-Y_1)$ can be represented as</p>
\[\begin{equation*}
	O_0^1 = \begin{bmatrix}
		-X_0\\
		-Y_0
	\end{bmatrix}
\end{equation*}\]
<h3 id="rotation">Rotation</h3>
<p>Assume a fixed frame $(O_0-X_0-Y_0)$ and a mobile frame $(O_1-X_1-Y_1)$. Let C be a point in space. The relation between both the frames and C can be derived using simple math.</p>
<p><img src="/assets/img/2DRobotics_new/3_Rota.png" alt="Image1" class="shadow" /></p>
<p>The following equations can be written down based on the above figure</p>
\[\hat{X_1} = (X_1\cos{\theta})\hat{X_0} + (X_1\sin{\theta})\hat{Y_0}\]
\[\hat{Y_1} = - (Y_1\sin{\theta})\hat{X_0} + (Y_1\cos{\theta})\hat{Y_0}\]
<p>Upon rearranging the terms,</p>
\[\begin{equation*}
	\begin{bmatrix}
		\hat{X_1}\\
		\hat{Y_1}\\
	\end{bmatrix}
 = \begin{bmatrix}
 	\cos{\theta} &amp; \sin{\theta}\\
 	-\sin{\theta} &amp; \cos{\theta}\\
 \end{bmatrix}
\begin{bmatrix}
	\hat{X_0}\\
	\hat{Y_0}\\
\end{bmatrix}
\end{equation*}\]
<p>The above trigonometric matrix is called the rotation matrix, denoted by $R$. The relation between the coordinates of point C in the fixed and mobile frame can therefore be expressed as:
\(C^1 = R_0^1C^0\)</p>
<h3 id="combined-translation--rotation">Combined Translation &amp; Rotation</h3>
<p>Assume a fixed frame $(O_0-X_0-Y_0)$ and a mobile frame $(O_2-X_2-Y_2)$. Let us assume an intermediate mobile frame given by $(O_1-X_1-Y_1)$. 
Let C be a point of interest, The frame $O_2$ can be generated by translation from frame $O_0$ to give frame $O_1$ and then rotation by $\theta$ to give frame $O_2$.</p>
<p><img src="/assets/img/2DRobotics_new/4_TrRo.png" alt="Image1" class="shadow" /></p>
<p>The coordinates of point C between the mobile and fixed frame can be related using the following:</p>
\[C^0 = O_1^0 + R_1^0C^1\]
<h2 id="2d---rr-manipulator">2D - RR Manipulator</h2>
<p>Consider the following manipulator diagram for a 2 DoF planar robotic arm.</p>
<p><img src="/assets/img/2DRobotics_new/5_RRmanu.png" alt="Image1" class="shadow" /></p>
<p>$P^1 = \begin{bmatrix}
	l_1<br />
	0<br />
\end{bmatrix};$</p>
<p>$Q^2 = \begin{bmatrix}
	l_2<br />
	0<br />
\end{bmatrix};$</p>
\[R_1^0 = \begin{bmatrix}
	\cos{\theta_1} &amp; -\sin{\theta_1} \\
	\sin{\theta_1} &amp; \cos{\theta_1} \\
\end{bmatrix}\]
\[R_2^1 = \begin{bmatrix}
	\cos{\theta_2} &amp; -\sin{\theta_2}\\
	\sin{\theta_2} &amp; \cos{\theta_2}\\
\end{bmatrix}\]
<p>$P^0 = R_1^0P^1$</p>
<p>$Q^1 = R_2^1Q^2 + P^1$</p>
<p>$Q^0 = R_1^0Q^1 = R_1^0(R_2^1Q^2 + P^1)$</p>
\[\begin{align}
	P^0 &amp;= \begin{bmatrix}
		X_p^0\\
		Y_p^0\\
	\end{bmatrix}=
\begin{bmatrix}
	l_1\cos{\theta_1}\\
	l_1\sin{\theta_1}
\end{bmatrix}\\
Q^0 &amp;= \begin{bmatrix}
	X_Q^0\\
	Y_Q^0\\
\end{bmatrix}
= \begin{bmatrix}
	l_1\cos{\theta_1} + l_2\cos{(\theta_1+\theta_2)}\\
	l_1\sin{\theta_1} + l_2\sin{(\theta_1+\theta_2)}\\
\end{bmatrix}
\end{align}\]
<h3 id="forward-kinematics">Forward Kinematics</h3>
<p>The equations for the RR manipulator can be used to draw the arm in MATLAB, the code for the same is given below.</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">%% Lec1_RRManu.m %%	</span>
<span class="nb">clc</span>
<span class="c1">%clear all</span>
<span class="nb">close</span> <span class="nb">all</span>
<span class="c1">%% Manipulator Parameters</span>
<span class="n">l1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">l2</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span> <span class="n">theta2</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">;</span>

<span class="c1">%% World Frame</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y_0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">%% Link 1</span>
<span class="n">x_p0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">);</span>
<span class="n">y_p0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">);</span>

<span class="c1">%% Link 2</span>
<span class="n">x_q0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1</span> <span class="o">+</span> <span class="n">theta2</span><span class="p">);</span>
<span class="n">y_q0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1</span> <span class="o">+</span> <span class="n">theta2</span><span class="p">);</span>

<span class="c1">%% Draw Lines</span>
<span class="nb">line</span><span class="p">([</span><span class="n">x_0</span><span class="p">,</span> <span class="n">x_p0</span><span class="p">],</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_p0</span><span class="p">],</span> <span class="s1">'Linewidth'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'Color'</span><span class="p">,</span> <span class="p">[</span><span class="mi">204</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">/</span> <span class="mi">255</span><span class="p">);</span>
<span class="nb">line</span><span class="p">([</span><span class="n">x_q0</span><span class="p">,</span> <span class="n">x_p0</span><span class="p">],</span> <span class="p">[</span><span class="n">y_q0</span><span class="p">,</span> <span class="n">y_p0</span><span class="p">],</span> <span class="s1">'Linewidth'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'Color'</span><span class="p">,</span> <span class="s1">'cyan'</span><span class="p">);</span>
<span class="nb">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'x'</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'y'</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'RR-Manipulator'</span><span class="p">)</span>

</pre></table></code></div></div>
<p>Upon executing the code you should be able see something similar in your figure window.</p>
<p><img src="/assets/img/2DRobotics/MATLAB_rr_manu.png" alt="Image1" class="shadow" /></p>
<h3 id="inverse-kinematics">Inverse Kinematics</h3>
<p>We can also solve for $\theta_1$ and $\theta_2$ given the end-effector position. This is most useful in everyday life implementation as we often know one way or another to which position our arm should move. This approach is called inverse kinematics. 
Below given program is a simple example on how we can use matlab to solve the obtained system of non-linear equations for a given value of end-effector positions  $\verb|x_ref,y_ref|$, using $fsolve$. Other numerical methods for solving system of non-linear equations that can be implemented from scratch will be discussed in later sections.</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="c1">%% Lec2_InverseRRManu.m %%</span>
<span class="nb">clc</span>
<span class="nb">close</span> <span class="nb">all</span>

<span class="n">l1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">l2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">x_ref</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">y_ref</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">param</span> <span class="o">=</span> <span class="p">[</span><span class="n">l1</span> <span class="n">l2</span> <span class="n">x_ref</span> <span class="n">y_ref</span><span class="p">];</span>

<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span> <span class="mf">0.1</span><span class="p">];</span>
<span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">fval</span><span class="p">,</span> <span class="n">exitflag</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="o">@</span><span class="n">Lec2_InvFun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">optimoptions</span><span class="p">(</span><span class="s1">'fsolve'</span><span class="p">,</span> <span class="s1">'Display'</span><span class="p">,</span> <span class="s1">'iter'</span><span class="p">),</span> <span class="n">param</span><span class="p">)</span>

<span class="n">theta1</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">theta2</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="c1">%% World Frame</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y_0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">%% Link 1</span>
<span class="n">x_p0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">);</span>
<span class="n">y_p0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">);</span>

<span class="c1">%% Link 2</span>
<span class="n">x_q0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1</span> <span class="o">+</span> <span class="n">theta2</span><span class="p">);</span>
<span class="n">y_q0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1</span> <span class="o">+</span> <span class="n">theta2</span><span class="p">);</span>

<span class="c1">%% Draw Lines</span>
<span class="nb">line</span><span class="p">([</span><span class="n">x_0</span><span class="p">,</span> <span class="n">x_p0</span><span class="p">],</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_p0</span><span class="p">],</span> <span class="s1">'Linewidth'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'Color'</span><span class="p">,</span> <span class="p">[</span><span class="mi">204</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">/</span> <span class="mi">255</span><span class="p">);</span>
<span class="nb">line</span><span class="p">([</span><span class="n">x_q0</span><span class="p">,</span> <span class="n">x_p0</span><span class="p">],</span> <span class="p">[</span><span class="n">y_q0</span><span class="p">,</span> <span class="n">y_p0</span><span class="p">],</span> <span class="s1">'Linewidth'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'Color'</span><span class="p">,</span> <span class="s1">'cyan'</span><span class="p">);</span>
<span class="nb">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'x'</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'y'</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'RR-Manipulator'</span><span class="p">)</span>

</pre></table></code></div></div>
<p>As you might have noticed the above program depends on an external function called \verb|Lec2_InvFun|. The code for the function is given below.</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c1">%% Lec2_InvFun.m %%</span>

<span class="k">function</span> <span class="n">F</span> <span class="o">=</span> <span class="n">Lec2_InvFun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

<span class="n">l1</span> <span class="o">=</span> <span class="n">param</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">l2</span> <span class="o">=</span> <span class="n">param</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">x_ref</span> <span class="o">=</span> <span class="n">param</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">y_ref</span> <span class="o">=</span> <span class="n">param</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">theta2</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="n">x_q0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1</span> <span class="o">+</span> <span class="n">theta2</span><span class="p">);</span>
<span class="n">y_q0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1</span> <span class="o">+</span> <span class="n">theta2</span><span class="p">);</span>

<span class="n">F</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_q0</span> <span class="o">-</span> <span class="n">x_ref</span><span class="p">;</span> <span class="n">y_q0</span> <span class="o">-</span> <span class="n">y_ref</span><span class="p">];</span>

<span class="k">end</span>


</pre></table></code></div></div>
<p>Upon executing the code you should be able see something similar in your figure window
<img src="/assets/img/2DRobotics/IKStat.png" alt="Image1" class="shadow" /></p>
<h3 id="tracing-trajectories">Tracing Trajectories</h3>
<p>If we can write the mathematical equation for a curve the x,y points on the curve can be passed into the inverse kinematics block for the manipulator which allows the robotic arm to trace the shape of the curve. The below given program does the same, it also shows the animation of the manipulator. Note, that the below given program uses $\verb|Lec2_InvFun|$ for running.</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="c1">%% Lec2_TrajManu.m %%</span>

<span class="nb">clc</span>
<span class="nb">close</span> <span class="nb">all</span>

<span class="c1">%% Parameter Setting</span>
<span class="n">l1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">l2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">%% Trajectory Generator</span>
<span class="n">phi</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">pi</span><span class="p">,</span> <span class="mi">51</span><span class="p">);</span>
<span class="n">x_ref</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span> <span class="n">y_ref</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span>

<span class="n">theta1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">theta2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">theta1_f</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">theta2_f</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>

<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">];</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">optimoptions</span><span class="p">(</span><span class="s1">'fsolve'</span><span class="p">,</span> <span class="s1">'Display'</span><span class="p">,</span> <span class="s1">'Off'</span><span class="p">,</span> <span class="s1">'MaxIter'</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'MaxFunEval'</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
    <span class="n">param</span> <span class="o">=</span> <span class="p">[</span><span class="n">l1</span> <span class="n">l2</span> <span class="n">x_ref</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">y_ref</span><span class="p">(</span><span class="n">i</span><span class="p">)];</span>
    <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">fval</span><span class="p">,</span> <span class="n">exitflag</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="o">@</span><span class="n">Lec2_InvFun</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">param</span><span class="p">);</span>
 
    <span class="n">theta1</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">theta2</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
 
    <span class="n">theta1_f</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">theta2_f</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
 
<span class="k">end</span>

<span class="c1">%% World Frame</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">y_0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">%% Animation</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
 
    <span class="c1">% Link 1</span>
    <span class="n">x_p0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1_f</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
    <span class="n">y_p0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1_f</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
 
    <span class="c1">% Link 2</span>
    <span class="n">x_q0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1_f</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta1_f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta2_f</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
    <span class="n">y_q0</span> <span class="o">=</span> <span class="n">l1</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1_f</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">+</span> <span class="n">l2</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta1_f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta2_f</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
 
    <span class="c1">% Tracer</span>
    <span class="nb">plot</span><span class="p">(</span><span class="n">x_q0</span><span class="p">,</span> <span class="n">y_q0</span><span class="p">,</span> <span class="s1">'ko'</span><span class="p">,</span> <span class="s2">"MarkerSize"</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'MarkerEdgeColor'</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">,</span> <span class="s1">'MarkerFaceColor'</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">);</span>
    <span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
 
    <span class="n">h1</span> <span class="o">=</span> <span class="nb">line</span><span class="p">([</span><span class="n">x_0</span><span class="p">,</span> <span class="n">x_p0</span><span class="p">],</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_p0</span><span class="p">],</span> <span class="s1">'Linewidth'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'Color'</span><span class="p">,</span> <span class="p">[</span><span class="mi">204</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">/</span> <span class="mi">255</span><span class="p">);</span>
    <span class="n">h2</span> <span class="o">=</span> <span class="nb">line</span><span class="p">([</span><span class="n">x_q0</span><span class="p">,</span> <span class="n">x_p0</span><span class="p">],</span> <span class="p">[</span><span class="n">y_q0</span><span class="p">,</span> <span class="n">y_p0</span><span class="p">],</span> <span class="s1">'Linewidth'</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">'Color'</span><span class="p">,</span> <span class="s1">'cyan'</span><span class="p">);</span>
    <span class="nb">grid</span> <span class="n">on</span><span class="p">;</span>
    <span class="nb">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">);</span>
    <span class="nb">xlabel</span><span class="p">(</span><span class="s1">'x'</span><span class="p">);</span>
    <span class="nb">ylabel</span><span class="p">(</span><span class="s1">'y'</span><span class="p">);</span>
    <span class="nb">title</span><span class="p">(</span><span class="s1">'RR-Manipulator'</span><span class="p">)</span>
    <span class="nb">xlim</span><span class="p">([</span><span class="o">-</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">]);</span>
    <span class="nb">ylim</span><span class="p">([</span><span class="o">-</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">]);</span>
 
    <span class="nb">pause</span><span class="p">(</span><span class="mf">0.3</span><span class="p">);</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">length</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="nb">delete</span><span class="p">(</span><span class="n">h1</span><span class="p">);</span>
        <span class="nb">delete</span><span class="p">(</span><span class="n">h2</span><span class="p">);</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></table></code></div></div>
<p>Upon executing the code you should be able see something similar in your figure window
<img src="/assets/img/2DRobotics/IKCircle.png" alt="Image1" class="shadow" /></p>
<h2 id="differential-drive">Differential Drive</h2>
<p>Consider a fixed frame ($O_0-X_0-Y_0$) and a mobile frame ($O_1-X_1-Y_1$), the mobile frame is attached to a two wheel differential drive robot, such that the $X_1$ axis is pointing forwards and the $Y_1$ is perpendicular to the orientation of the wheels.
<img src="/assets/img/2DRobotics_new/6_DiffCarFrames.png" alt="Image1" class="shadow" /></p>
<p>Let $r$ be the radius of the wheels and $2b$ be the distance between the wheels, and $\theta$ be the angle the angle the mobile frame makes with the horizontal of the fixed frame. 
<img src="/assets/img/2DRobotics_new/7_DiffCar.png" alt="Image1" class="shadow" /></p>
<h3 id="forward-kinematics-1">Forward Kinematics</h3>
<p>The forward kinematics of the differential drive car involves finding ($X_C^0(t),Y_C^0(t)$) given $b,r$, initial position ($X_C^0(t=0),Y_C^0(t=0)$) and the driving history of the robot  ($\dot{\phi_r}(t),\dot{\phi_l}(t)$).</p>
<p>The distance traveled by the wheel if it rotates by an angle $\phi$ is given by $r\phi$. The rate of change of distance travelled by the wheel is therefore given by $r\dot{\phi}$. Assuming the right wheel is denoted by the subscript r, similar assumptions and derivations can be made for the left wheel.</p>
<p><img src="/assets/img/2DRobotics_new/8_DiffWheel.png" alt="Image1" class="shadow" /></p>
<p>Case 1: $\dot{\phi_l}=0, \dot{\phi_r}\neq0$</p>
<p>The distance moved by the right wheel is given by, $X_{wr}=r\phi_r$. The velocity of the right wheel is given by,</p>
\[\dot{X_{wr}^1} =r\dot{\phi_r}\]
<p><img src="/assets/img/2DRobotics_new/9_DiffRVel.png" alt="Image1" class="shadow" /></p>
<p>From geometry, the speed of the center C in the direction of $X_1$ can be written as,</p>
\[\dot{X_C^1}= 0.5r\dot{\phi_r}\]
<p>Case 2: $\dot{\phi_l}\neq0, \dot{\phi_r}=0$</p>
<p>From symmetry similar arguments can be made for the left wheel, giving the following equations.</p>
\[\dot{X_{wl}^1} =r\dot{\phi_l}\]
\[\dot{X_C^1}= 0.5r\dot{\phi_l}\]
<p>From case 1 \&amp; 2, the velocity of the point C in the directions of $X_1$ and $Y_1$ can be written down as,</p>
\[\begin{align}
	\dot{X_C^1} &amp;= 0.5r(\dot{\phi_l}+\dot{\phi_r})\\
	\dot{Y_C^1} &amp;= 0
\end{align}\]
<p>The velocity of point C in frame 0 and 1 can be related as,</p>
\[\begin{align*}
	\dot{C^0} &amp;= R_1^0\dot{C^1}\\
	\begin{bmatrix}
		\dot{X_C^0}\\
		\dot{Y_C^0}
	\end{bmatrix} &amp;=
	\begin{bmatrix}
		\cos{\theta} &amp; -\sin{\theta}\\
		\sin{\theta} &amp; \cos{\theta}\\ 
	\end{bmatrix}
	\begin{bmatrix}
		\dot{X_C^1}\\
		\dot{Y_C^1}
	\end{bmatrix}\\
	\begin{bmatrix}
		\dot{X_C^0}\\
		\dot{Y_C^0}
	\end{bmatrix} &amp;=
	\begin{bmatrix}
		\cos{\theta} &amp; -\sin{\theta}\\
		\sin{\theta} &amp; \cos{\theta}\\ 
	\end{bmatrix}
	\begin{bmatrix}
		0.5r(\dot{\phi_r}+\dot{\phi_l})\\
		0
	\end{bmatrix}\\
	\dot{X_C^0(t)} &amp;= 0.5r(\dot{\phi_r}+\dot{\phi_l})\cos{\theta}\\
	\dot{Y_C^0(t)} &amp;= 0.5r(\dot{\phi_r}+\dot{\phi_l})\sin{\theta}
\end{align*}\]
<p>For finding the expression for rate of change of $\theta$,</p>
<p>Case 1: $\dot{\phi_l}=0, \dot{\phi_r}\neq0$</p>
\[X_{wr} = r\phi_r\]
<p>from geometry,</p>
\[X_{wr} = 2b\theta\]
<p>therefore gives,</p>
\[\dot{\theta} = \dfrac{r\dot{\phi_r}}{2b}\]
<p>Similar arguments can be made for the other case, only exception being the angle $\theta$ is negative. Therefore from case 1 and 2 the following can be derived.</p>
\[\dot{\theta} = \dfrac{r}{2b}(\dot{\phi_r}-\dot{\phi_l})\]
<p>Therefore to summarize,</p>
\[\begin{align*}
\dot{X_C^0} &amp;= v\cos{\theta}\\
\dot{Y_C^0} &amp;= v\sin{\theta}\\
\dot{\theta} &amp;= \omega\\
v &amp;= 0.5r(\dot{\phi_r}+\dot{\phi_l})\\
w &amp;= \dfrac{r}{2b}(\dot{\phi_r}-\dot{\phi_l})
\end{align*}\]
<p>To find $X_C^0,Y_C^0,\theta$, we will be using Euler’s integration.</p>
\[\begin{align*}
	\dot{X_C^0} &amp;= \dfrac{X_C(t_{i+1})-X_C(t_i)}{t_{i+1}-t_i} = v(t_i)\cos{\theta(t_i)}\\ 
	\dot{Y_C^0} &amp;= \dfrac{Y_C(t_{i+1})-Y_C(t_i)}{t_{i+1}-t_i} = v(t_i)\sin{\theta(t_i)}\\
	\dot{\theta} &amp;= \dfrac{\theta(t_{i+1})-\theta(t_i)}{t_{i+1}-t_i} = \omega(t_i)
\end{align*}\]
<p>Upon rearranging the terms,</p>
\[\begin{align*}
	X_C^0(t_{i+1}) &amp;= X_C^0(t_{i}) + hv(t_{i})\cos{\theta(t_i)}\\
	Y_C^0(t_{i+1}) &amp;= Y_C^0(t_{i}) + hv(t_{i})\sin{\theta(t_i)}\\
	\theta(t_{i+1}) &amp;= \theta(t_i) + h\omega(t_i)
\end{align*}\]
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre><td class="rouge-code"><pre><span class="c1">%% Lec3_DiffCar.m %%</span>

<span class="nb">clc</span>
<span class="nb">close</span> <span class="nb">all</span>

<span class="n">parms</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> <span class="c1">%Radius of the chassis for animation</span>

<span class="c1">% parms.writeMovie = 0; %set to 1 to get a movie output</span>
<span class="c1">% parms.nameMovie = 'car.avi';</span>

<span class="c1">%% Initialize States</span>
<span class="n">fps</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">parms</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>
<span class="n">z0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="o">-</span> <span class="nb">pi</span> <span class="p">/</span> <span class="mi">2</span><span class="p">];</span> <span class="c1">%initial position of the car</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span> <span class="c1">%step size</span>

<span class="c1">%% Motion</span>
<span class="n">t1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span>
<span class="n">speed1</span> <span class="o">=</span> <span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">t1</span><span class="p">));</span>
<span class="n">omega1</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">t1</span><span class="p">));</span>

<span class="n">t2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">2</span><span class="p">;</span>
<span class="n">speed2</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">t2</span><span class="p">));</span>
<span class="n">omega2</span> <span class="o">=</span> <span class="nb">pi</span> <span class="p">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">t2</span><span class="p">));</span>

<span class="n">t3</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">3</span><span class="p">;</span>
<span class="n">speed3</span> <span class="o">=</span> <span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">t3</span><span class="p">));</span>
<span class="n">omega3</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">length</span><span class="p">(</span><span class="n">t3</span><span class="p">));</span>
<span class="n">t4</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">4</span><span class="p">;</span>
<span class="n">t5</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">5</span><span class="p">;</span>
<span class="n">t6</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">6</span><span class="p">;</span>
<span class="n">t7</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">7</span><span class="p">;</span>

<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="n">t1</span> <span class="n">t2</span> <span class="n">t3</span> <span class="n">t4</span> <span class="n">t5</span> <span class="n">t6</span> <span class="n">t7</span><span class="p">];</span>
<span class="n">speed</span> <span class="o">=</span> <span class="p">[</span><span class="n">speed1</span> <span class="n">speed2</span> <span class="n">speed3</span> <span class="n">speed2</span> <span class="n">speed3</span> <span class="n">speed2</span> <span class="n">speed3</span><span class="p">];</span>
<span class="n">omega</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega1</span> <span class="n">omega2</span> <span class="n">omega3</span> <span class="n">omega2</span> <span class="n">omega3</span> <span class="n">omega2</span> <span class="n">omega3</span><span class="p">];</span>

<span class="c1">%% Euler Integration</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">z0</span><span class="p">;</span> <span class="c1">%Initial parameters</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">u</span> <span class="o">=</span> <span class="p">[</span><span class="n">speed</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">omega</span><span class="p">(</span><span class="n">i</span><span class="p">)];</span>
    <span class="n">zz</span> <span class="o">=</span> <span class="n">Lec3_Euler</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
    <span class="n">z0</span> <span class="o">=</span> <span class="n">zz</span><span class="p">;</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span><span class="p">;</span> <span class="n">z0</span><span class="p">];</span>
<span class="k">end</span>

<span class="c1">% t_interp = linspace(0,t(end),fps*t(end));</span>
<span class="c1">% [m,n] = size(z);</span>
<span class="c1">% for i=1:n</span>
<span class="c1">%     z_interp(:,i) = interp1(t,z(:,i),t_interp);</span>
<span class="c1">% end</span>

<span class="c1">%% Animation</span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Lec3_Animate</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">parms</span><span class="p">);</span>

</pre></table></code></div></div>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="c1">%% Lec3_Animate.m %%</span>

<span class="k">function</span> <span class="n">Lec3_Animate</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">parms</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">parms</span><span class="o">.</span><span class="n">R</span><span class="p">;</span>
<span class="n">phi</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">pi</span><span class="p">);</span>
<span class="n">x_circle</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span>
<span class="n">y_circle</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span>

<span class="c1">% if (parms.writeMovie)</span>
<span class="c1">%     mov = VideoWriter(parms.nameMovie);</span>
<span class="c1">%     open(mov);</span>
<span class="c1">%end</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
    <span class="n">x_robot</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">x_circle</span><span class="p">;</span>
    <span class="n">y_robot</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">y_circle</span><span class="p">;</span>
    <span class="n">x_dir</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span> <span class="n">R</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)];</span>
    <span class="n">y_dir</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span> <span class="n">R</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)];</span>
 
    <span class="nb">plot</span><span class="p">(</span><span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">'r'</span><span class="p">,</span> <span class="s1">'Linewidth'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
    <span class="n">light_blue</span> <span class="o">=</span> <span class="p">[</span><span class="mi">176</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">230</span><span class="p">]</span> <span class="p">/</span> <span class="mi">255</span><span class="p">;</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="nb">patch</span><span class="p">(</span><span class="n">x_robot</span><span class="p">,</span> <span class="n">y_robot</span><span class="p">,</span> <span class="n">light_blue</span><span class="p">);</span>
    <span class="n">h2</span> <span class="o">=</span> <span class="nb">line</span><span class="p">(</span><span class="n">x_dir</span><span class="p">,</span> <span class="n">y_dir</span><span class="p">,</span> <span class="s1">'Color'</span><span class="p">,</span> <span class="s1">'black'</span><span class="p">,</span> <span class="s1">'Linewidth'</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="nb">axis</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">);</span>
    <span class="c1">%span = max([-min(min(z(:,1:2))) max(max(z(:,1:2)))]);</span>
    <span class="c1">%span = max([span 2]);</span>
    <span class="c1">%axis([-span span -span span]);</span>
    <span class="nb">axis</span><span class="p">([</span><span class="o">-</span> <span class="mi">2</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">]);</span>
    <span class="nb">grid</span> <span class="n">on</span><span class="p">;</span>
 
    <span class="nb">pause</span><span class="p">(</span><span class="n">parms</span><span class="o">.</span><span class="n">delay</span><span class="p">)</span>
    <span class="nb">delete</span><span class="p">(</span><span class="n">h1</span><span class="p">);</span>
    <span class="nb">delete</span><span class="p">(</span><span class="n">h2</span><span class="p">);</span>
    <span class="c1">%     if (parms.writeMovie)</span>
    <span class="c1">%         axis off %does not show axis</span>
    <span class="c1">%         set(gcf,'Color',[1,1,1]) %set background to white</span>
    <span class="c1">%         writeVideo(mov,getframe);</span>
    <span class="c1">%     end</span>
 
<span class="k">end</span>

<span class="c1">% if (parms.writeMovie)</span>
<span class="c1">%     close(mov);</span>
<span class="k">end</span>


</pre></table></code></div></div>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="c1">%% Lec3_Euler.m %%</span>

<span class="k">function</span> <span class="n">F</span> <span class="o">=</span> <span class="n">Lec3_Euler</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="n">x_t0</span> <span class="o">=</span> <span class="n">z0</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">y_t0</span> <span class="o">=</span> <span class="n">z0</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">theta_t0</span> <span class="o">=</span> <span class="n">z0</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

<span class="n">xdot_c</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta_t0</span><span class="p">);</span>
<span class="n">ydot_c</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta_t0</span><span class="p">);</span>
<span class="n">thetadot</span> <span class="o">=</span> <span class="n">omega</span><span class="p">;</span>

<span class="n">x_t1</span> <span class="o">=</span> <span class="n">x_t0</span> <span class="o">+</span> <span class="n">xdot_c</span> <span class="o">*</span> <span class="n">h</span><span class="p">;</span>
<span class="n">y_t1</span> <span class="o">=</span> <span class="n">y_t0</span> <span class="o">+</span> <span class="n">ydot_c</span> <span class="o">*</span> <span class="n">h</span><span class="p">;</span>
<span class="n">theta_t1</span> <span class="o">=</span> <span class="n">theta_t0</span> <span class="o">+</span> <span class="n">thetadot</span> <span class="o">*</span> <span class="n">h</span><span class="p">;</span>

<span class="n">F</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_t1</span><span class="p">,</span> <span class="n">y_t1</span><span class="p">,</span> <span class="n">theta_t1</span><span class="p">];</span>

<span class="k">end</span>


</pre></table></code></div></div>
<p>Upon successful execution of the above program you should be able to see a figure similar to this</p>
<p><img src="/assets/img/2DRobotics/DiffPlot.png" alt="Image1" class="shadow" /></p>
<h3 id="inverse-kinematics-1">Inverse Kinematics</h3>
<p>Inverse Kinematics is defined as finding the values of $v,\omega$ given ($X_P^0,Y_p^0$) as a function of time, where $P$ is a point fixed on the robot as shown in the figure.</p>
<p><img src="/assets/img/2DRobotics_new/10_DiffP.png" alt="Image1" class="shadow" /></p>
<p>From previous sections, we have the following relations</p>
\[\begin{align*}
	P^0 &amp;= R_1^0P^1\\
	C^0 &amp;= R_1^0C^1\\
	P^0 - C^0 &amp;= R_1^0(P^1-C^1)\\
	\begin{bmatrix}
		X_P^0 - X_C^0\\
		X_P^0 - Y_C^0
	\end{bmatrix} &amp;=
	\begin{bmatrix}
		\cos{\theta} &amp; -\sin{\theta}\\
		\sin{\theta} &amp; \cos{\theta}
	\end{bmatrix}
	\begin{bmatrix}
		X_P^1 - X_C^1\\
		Y_p^1 - Y_C^1
	\end{bmatrix}\\
	\begin{bmatrix}
		X_P^0 - X_C^0\\
		X_P^0 - Y_C^0
	\end{bmatrix} &amp;=
	\begin{bmatrix}
		\cos{\theta} &amp; -\sin{\theta}\\
		\sin{\theta} &amp; \cos{\theta}
	\end{bmatrix}
	\begin{bmatrix}
		P_X\\
		P_Y
	\end{bmatrix}\\
	\begin{bmatrix}
		X_P^0\\
		Y_P^0
	\end{bmatrix} &amp;=
	\begin{bmatrix}
		X_C^0\\
		Y_C^0
	\end{bmatrix} + 
\begin{bmatrix}
	\cos{\theta} &amp; -\sin{\theta}\\
	\sin{\theta} &amp; \cos{\theta}
\end{bmatrix}
\begin{bmatrix}
	P_X\\
	P_Y
\end{bmatrix}\\
	\begin{bmatrix}
	X_C^0\\
	Y_C^0
\end{bmatrix} &amp;=
\begin{bmatrix}
	X_P^0\\
	Y_P^0
\end{bmatrix} + 
\begin{bmatrix}
	\cos{\theta} &amp; -\sin{\theta}\\
	\sin{\theta} &amp; \cos{\theta}
\end{bmatrix}
\begin{bmatrix}
	P_X\\
	P_Y
\end{bmatrix}\\
\end{align*}\]
<p>Differentiating the above equations with time,</p>
\[\begin{align*}
	\begin{bmatrix}
		\dot{X_P^0}\\
		\dot{Y_P^0}
	\end{bmatrix} &amp;=
	\begin{bmatrix}
		\dot{X_C^0}\\
		\dot{Y_C^0}
	\end{bmatrix} + 
	\begin{bmatrix}
		\dot{\theta}\sin{\theta} &amp; -\dot{\theta}\cos{\theta}\\
		\dot{\theta}\cos{\theta} &amp; -\dot{\theta}\sin{\theta}
	\end{bmatrix}
	\begin{bmatrix}
		P_X\\
		P_Y
	\end{bmatrix}\\
	\begin{bmatrix}
		\dot{X_P^0}\\
		\dot{Y_P^0}
	\end{bmatrix} &amp;=
	\begin{bmatrix}
		v\cos{\theta}\\
		v\sin{\theta}
	\end{bmatrix} + 
	\begin{bmatrix}
		\omega\sin{\theta} &amp; -\omega\cos{\theta}\\
		\omega\cos{\theta} &amp; -\omega\sin{\theta}
	\end{bmatrix}
	\begin{bmatrix}
		P_X\\
		P_Y
	\end{bmatrix}\\
	\begin{bmatrix}
		\dot{X_P^0}\\
		\dot{Y_P^0}
	\end{bmatrix} &amp;=
	\begin{bmatrix}
		\cos{\theta} &amp; (-P_X\sin{\theta} - P_Y\cos{\theta})\\
		\sin{\theta} &amp; (P_X\cos{\theta} - P_Y\sin{\theta})
	\end{bmatrix}
	\begin{bmatrix}
		v\\
		\omega
	\end{bmatrix}
\end{align*}\]
<p>We will be using a proportional controller for driving the error towards zero.</p>
\[\dot{X_P^0} = K_{P_x}(X_{ref}-X_P^0)\]
\[\dot{Y_P^0} = K_{P_Y}(Y_{ref}-Y_P^0)\]
<p>Where $K_{P_x},K_{P_y}$ are user chosen gains and $X_{ref},Y_{ref}$ are the desired reference points. Substituting these values in the above derived equations.
\(\begin{align*}
		\begin{bmatrix}
			K_{P_x}(X_{ref}-X_P^0)\\
			K_{P_Y}(Y_{ref}-Y_P^0)
		\end{bmatrix} &amp;=
		\begin{bmatrix}
			\cos{\theta} &amp; (-P_X\sin{\theta} - P_Y\cos{\theta})\\
			\sin{\theta} &amp; (P_X\cos{\theta} - P_Y\sin{\theta})
		\end{bmatrix}
		\begin{bmatrix}
			v\\
			\omega
		\end{bmatrix}\\
		\begin{bmatrix}
			v\\
			\omega
		\end{bmatrix} &amp;=
		\begin{bmatrix}
			\cos{\theta} - \left(\dfrac{P_X}{P_Y}\right) \sin{\theta} &amp; \sin{\theta} + \left( \dfrac{P_X}{P_Y}\right) \cos{\theta}\\
			-\left( \dfrac{1}{P_X}\right) \sin{\theta} &amp; -\left( \dfrac{1}{P_X}\right) \cos{\theta} 
		\end{bmatrix}
		\begin{bmatrix}
			K_{P_x}(X_{ref}-X_P^0)\\
			K_{P_Y}(Y_{ref}-Y_P^0)
		\end{bmatrix}
	\end{align*}\)</p>
<p>Also from forward kinematics we know the following,</p>
\[\begin{align*}
	\dot{X_C^0} &amp;= v\cos{\theta}\\
	\dot{Y_C^0} &amp;= v\sin{\theta}\\
	\dot{\theta} &amp;= \omega
\end{align*}\]
<p>All of the above derived equations can be used to create a trajectory following differential drive robot the code attached below follows a mathematical trajectory called “astroid” the code also has an PD controller implemented to keep the error close to zero.</p>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre><td class="rouge-code"><pre><span class="c1">%% Lec4_InvDiff.m %%</span>

<span class="nb">clc</span>
<span class="nb">close</span> <span class="nb">all</span>
<span class="c1">%% Parameters</span>
<span class="n">parms</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">parms</span><span class="o">.</span><span class="n">px</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span>
<span class="n">parms</span><span class="o">.</span><span class="n">py</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">parms</span><span class="o">.</span><span class="n">Kp</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">parms</span><span class="o">.</span><span class="n">Kd</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">parms</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">;</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">tend</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">fps</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">t0</span><span class="p">:</span><span class="mf">0.01</span><span class="p">:</span><span class="n">tend</span><span class="p">;</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="c1">%% Trajectory</span>
<span class="n">x_center</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">y_center</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">x_ref</span> <span class="o">=</span> <span class="n">x_center</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="p">/</span> <span class="n">tend</span><span class="p">)</span> <span class="o">.^</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">y_ref</span> <span class="o">=</span> <span class="n">y_center</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="p">/</span> <span class="n">tend</span><span class="p">)</span> <span class="o">.^</span> <span class="mi">3</span><span class="p">;</span>
<span class="c1">%% Initilization</span>
<span class="n">theta0</span> <span class="o">=</span> <span class="nb">pi</span> <span class="p">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">[</span><span class="n">x0</span> <span class="n">y0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Lec4_ptP_to_ptC</span><span class="p">(</span><span class="n">x_ref</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">y_ref</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">parms</span><span class="p">);</span>
<span class="n">z0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span> <span class="n">y0</span> <span class="n">theta0</span><span class="p">];</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">z0</span><span class="p">;</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="k">end</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">y_c</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="k">end</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="k">end</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
 
    <span class="p">[</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">]</span> <span class="o">=</span> <span class="n">Lec4_ptC_to_ptP</span><span class="p">(</span><span class="n">x_c</span><span class="p">,</span> <span class="n">y_c</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">parms</span><span class="p">);</span>
 
    <span class="nb">error</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_ref</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_p</span> <span class="n">y_ref</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_p</span><span class="p">];</span>
    <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="p">;</span> <span class="nb">error</span><span class="p">];</span>
    <span class="n">err_p_dot</span> <span class="o">=</span> <span class="p">[</span><span class="n">parms</span><span class="o">.</span><span class="n">Kp</span> <span class="o">*</span> <span class="nb">error</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">parms</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="p">((</span><span class="n">e</span><span class="p">(</span><span class="k">end</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">e</span><span class="p">(</span><span class="k">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">/</span> <span class="n">h</span><span class="p">);</span> <span class="n">parms</span><span class="o">.</span><span class="n">Kp</span> <span class="o">*</span> <span class="nb">error</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">parms</span><span class="o">.</span><span class="n">Kd</span> <span class="o">*</span> <span class="p">((</span><span class="n">e</span><span class="p">(</span><span class="k">end</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">e</span><span class="p">(</span><span class="k">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">/</span> <span class="n">h</span><span class="p">)];</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span>
    <span class="n">px</span> <span class="o">=</span> <span class="n">parms</span><span class="o">.</span><span class="n">px</span><span class="p">;</span> <span class="n">py</span> <span class="o">=</span> <span class="n">parms</span><span class="o">.</span><span class="n">py</span><span class="p">;</span>
    <span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="p">(</span><span class="n">py</span> <span class="p">/</span> <span class="n">px</span><span class="p">)</span> <span class="o">*</span> <span class="n">s</span> <span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="n">py</span> <span class="p">/</span> <span class="n">px</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">;</span> <span class="k">...</span>
     <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="p">/</span> <span class="n">px</span><span class="p">)</span> <span class="o">*</span> <span class="n">s</span> <span class="p">(</span><span class="mi">1</span> <span class="p">/</span> <span class="n">px</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">];</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">err_p_dot</span><span class="p">;</span> <span class="c1">%u = [v omega]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">;</span> <span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">)];</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega</span><span class="p">;</span> <span class="n">u</span><span class="p">(</span><span class="mi">2</span><span class="p">)];</span>
    <span class="c1">%zz = ode4(@Lec4_RHS,[t(i) t(i+1)],z0,u);</span>
    <span class="n">zz</span> <span class="o">=</span> <span class="n">Lec3_Euler</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">z0</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
    <span class="n">z0</span> <span class="o">=</span> <span class="n">zz</span><span class="p">(</span><span class="k">end</span><span class="p">,</span> <span class="p">:);</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="n">z</span><span class="p">;</span> <span class="n">z0</span><span class="p">];</span>
<span class="k">end</span>
<span class="n">t_interp</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tend</span><span class="p">,</span> <span class="n">fps</span> <span class="o">*</span> <span class="n">tend</span><span class="p">);</span>
<span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">z</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="n">z_interp</span><span class="p">(:,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">interp1</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">(:,</span> <span class="n">i</span><span class="p">),</span> <span class="n">t_interp</span><span class="p">);</span>
<span class="k">end</span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Lec3_Animate</span><span class="p">(</span><span class="n">t_interp</span><span class="p">,</span> <span class="n">z_interp</span><span class="p">,</span> <span class="n">parms</span><span class="p">);</span>
<span class="nb">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s1">'m'</span><span class="p">);</span> <span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Velocity'</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s1">'v'</span><span class="p">,</span> <span class="s1">'\omega'</span><span class="p">,</span> <span class="s1">'Location'</span><span class="p">,</span> <span class="s1">'Best'</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">e</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">'r'</span><span class="p">);</span> <span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">e</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">'b'</span><span class="p">);</span>
<span class="nb">legend</span><span class="p">(</span><span class="s1">'error x'</span><span class="p">,</span> <span class="s1">'error y'</span><span class="p">,</span> <span class="s1">'Location'</span><span class="p">,</span> <span class="s1">'Best'</span><span class="p">);</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'error'</span><span class="p">);</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'time'</span><span class="p">);</span>
</pre></table></code></div></div>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1">%% Lec4_ptC_to_ptP.m %%</span>

<span class="k">function</span> <span class="p">[</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">]</span> <span class="o">=</span> <span class="n">Lec4_ptC_to_ptP</span><span class="p">(</span><span class="n">x_c</span><span class="p">,</span> <span class="n">y_c</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">parms</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">parms</span><span class="o">.</span><span class="n">px</span><span class="p">;</span> <span class="n">parms</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="n">Xp</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="n">s</span><span class="p">;</span> <span class="n">s</span> <span class="n">c</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="p">[</span><span class="n">x_c</span><span class="p">;</span> <span class="n">y_c</span><span class="p">];</span>
<span class="n">x_p</span> <span class="o">=</span> <span class="n">Xp</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">y_p</span> <span class="o">=</span> <span class="n">Xp</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="k">end</span>
</pre></table></code></div></div>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1">%% Lec4_ptP_to_ptC.m %%</span>
<span class="k">function</span> <span class="p">[</span><span class="n">x_c</span><span class="p">,</span> <span class="n">y_c</span><span class="p">]</span> <span class="o">=</span> <span class="n">Lec4_ptP_to_ptC</span><span class="p">(</span><span class="n">x_p</span><span class="p">,</span> <span class="n">y_p</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">parms</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">parms</span><span class="o">.</span><span class="n">px</span><span class="p">;</span> <span class="n">parms</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="n">Xc</span> <span class="o">=</span> <span class="o">-</span> <span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="n">s</span><span class="p">;</span> <span class="n">s</span> <span class="n">c</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="p">[</span><span class="n">x_p</span><span class="p">;</span> <span class="n">y_p</span><span class="p">];</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">Xc</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">y_c</span> <span class="o">=</span> <span class="n">Xc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

<span class="k">end</span>
</pre></table></code></div></div>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre><span class="c1">%% ode4.m %%</span>

<span class="k">function</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">ode4</span><span class="p">(</span><span class="n">odefun</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="nb">varargin</span><span class="p">)</span>
<span class="c1">%ODE4  Solve differential equations with a non-adaptive method of order 4.</span>
<span class="c1">%   Y = ODE4(ODEFUN,TSPAN,Y0) with TSPAN = [T1, T2, T3, ... TN] integrates</span>
<span class="c1">%   the system of differential equations y' = f(t,y) by stepping from T0 to</span>
<span class="c1">%   T1 to TN. Function ODEFUN(T,Y) must return f(t,y) in a column vector.</span>
<span class="c1">%   The vector Y0 is the initial conditions at T0. Each row in the solution</span>
<span class="c1">%   array Y corresponds to a time specified in TSPAN.</span>
<span class="c1">%</span>
<span class="c1">%   Y = ODE4(ODEFUN,TSPAN,Y0,P1,P2...) passes the additional parameters</span>
<span class="c1">%   P1,P2... to the derivative function as ODEFUN(T,Y,P1,P2...).</span>
<span class="c1">%</span>
<span class="c1">%   This is a non-adaptive solver. The step sequence is determined by TSPAN</span>
<span class="c1">%   but the derivative function ODEFUN is evaluated multiple times per step.</span>
<span class="c1">%   The solver implements the classical Runge-Kutta method of order 4.</span>
<span class="c1">%</span>
<span class="c1">%   Example</span>
<span class="c1">%         tspan = 0:0.1:20;</span>
<span class="c1">%         y = ode4(@vdp1,tspan,[2 0]);</span>
<span class="c1">%         plot(tspan,y(:,1));</span>
<span class="c1">%     solves the system y' = vdp1(t,y) with a constant step size of 0.1,</span>
<span class="c1">%     and plots the first component of the solution.</span>
<span class="c1">%</span>

<span class="k">if</span> <span class="o">~</span> <span class="nb">isnumeric</span><span class="p">(</span><span class="n">tspan</span><span class="p">)</span>
    <span class="nb">error</span><span class="p">(</span><span class="s1">'TSPAN should be a vector of integration steps.'</span><span class="p">);</span>
<span class="k">end</span>

<span class="k">if</span> <span class="o">~</span> <span class="nb">isnumeric</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
    <span class="nb">error</span><span class="p">(</span><span class="s1">'Y0 should be a vector of initial conditions.'</span><span class="p">);</span>
<span class="k">end</span>

<span class="n">h</span> <span class="o">=</span> <span class="nb">diff</span><span class="p">(</span><span class="n">tspan</span><span class="p">);</span>
<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">sign</span><span class="p">(</span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">h</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nb">error</span><span class="p">(</span><span class="s1">'Entries of TSPAN are not in order.'</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">try</span>
    <span class="n">f0</span> <span class="o">=</span> <span class="nb">feval</span><span class="p">(</span><span class="n">odefun</span><span class="p">,</span> <span class="n">tspan</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">y0</span><span class="p">,</span> <span class="nb">varargin</span><span class="p">{:});</span>
<span class="k">catch</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Unable to evaluate the ODEFUN at t0,y0. '</span><span class="p">,</span> <span class="nb">lasterr</span><span class="p">];</span>
    <span class="nb">error</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
<span class="k">end</span>

<span class="n">y0</span> <span class="o">=</span> <span class="n">y0</span><span class="p">(:);</span> <span class="c1">% Make a column vector.</span>
<span class="k">if</span> <span class="o">~</span> <span class="nb">isequal</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">y0</span><span class="p">),</span> <span class="nb">size</span><span class="p">(</span><span class="n">f0</span><span class="p">))</span>
    <span class="nb">error</span><span class="p">(</span><span class="s1">'Inconsistent sizes of Y0 and f(t0,y0).'</span><span class="p">);</span>
<span class="k">end</span>

<span class="n">neq</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">y0</span><span class="p">);</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">tspan</span><span class="p">);</span>
<span class="n">Y</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">neq</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>
<span class="n">F</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">neq</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

<span class="n">Y</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">y0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">:</span><span class="n">N</span>
    <span class="n">ti</span> <span class="o">=</span> <span class="n">tspan</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">yi</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(:,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">F</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="nb">feval</span><span class="p">(</span><span class="n">odefun</span><span class="p">,</span> <span class="n">ti</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="nb">varargin</span><span class="p">{:});</span>
    <span class="n">F</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">feval</span><span class="p">(</span><span class="n">odefun</span><span class="p">,</span> <span class="n">ti</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">hi</span><span class="p">,</span> <span class="n">yi</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">hi</span> <span class="o">*</span> <span class="n">F</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">varargin</span><span class="p">{:});</span>
    <span class="n">F</span><span class="p">(:,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">feval</span><span class="p">(</span><span class="n">odefun</span><span class="p">,</span> <span class="n">ti</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">hi</span><span class="p">,</span> <span class="n">yi</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">hi</span> <span class="o">*</span> <span class="n">F</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">varargin</span><span class="p">{:});</span>
    <span class="n">F</span><span class="p">(:,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="nb">feval</span><span class="p">(</span><span class="n">odefun</span><span class="p">,</span> <span class="n">tspan</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">yi</span> <span class="o">+</span> <span class="n">hi</span> <span class="o">*</span> <span class="n">F</span><span class="p">(:,</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">varargin</span><span class="p">{:});</span>
    <span class="n">Y</span><span class="p">(:,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">yi</span> <span class="o">+</span> <span class="p">(</span><span class="n">hi</span> <span class="p">/</span> <span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">F</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">F</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">F</span><span class="p">(:,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="p">(:,</span> <span class="mi">4</span><span class="p">));</span>
<span class="k">end</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.'</span><span class="p">;</span>

</pre></table></code></div></div>
<div class="language-matlab highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1">%% Lec4_RHS.m %%</span>

<span class="k">function</span> <span class="n">zdot</span> <span class="o">=</span> <span class="n">Lec4_RHS</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">z</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">x_c_dot</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="nb">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span>
<span class="n">y_c_dot</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="nb">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">);</span>
<span class="n">theta_dot</span> <span class="o">=</span> <span class="n">omega</span><span class="p">;</span>
<span class="n">zdot</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_c_dot</span> <span class="n">y_c_dot</span> <span class="n">theta_dot</span><span class="p">]</span><span class="o">'</span><span class="p">;</span>

</pre></table></code></div></div>
<p>Upon successful execution of the above program, you will end up with the following two figures.
<img src="/assets/img/2DRobotics/DiffFinal.png" alt="Image1" class="shadow" /></p>
<h2 id="projectile-motion">Projectile Motion</h2>
<p>2-D projectile motion will be analyzed in this section, Euler Lagrange Equations will be introduced and used for finding out the equations of motion of the projectile.</p>
<h3 id="forward-kinematics-2">Forward Kinematics</h3>
<p>Let the position of the projectile wrt to the fixed frame be denoted as ($X,Y$). The launch angle is denoted by $\theta$ and the drag force is given by $\vec{F_d}=-Cv^2\hat{v}$.</p>
\[\vec{F_d}=-Cv^2\hat{v} = -Cv^2\dfrac{\vec{v}}{|\vec{v}|} = -C|v|\hat{v}\]
\[F_x = -C\dot{x}\sqrt{\dot{x}^2 + \dot{y}^2}\]
\[F_y = -C\dot{y}\sqrt{\dot{x}^2 + \dot{y}^2}\]
<p>From Euler-Lagrange Formulaizm,</p>
\[\begin{align*}
	L &amp;= T - V\\
	T &amp;= 0.5mv^2 = 0.5m(\dot{x}^2+\dot{y}^2)\\
	V &amp;= mgy\\
	L &amp;= 0.5m(\dot{x}^2+\dot{y}^2) - mgy
\end{align*}\]
<p>Given that,</p>
\[\begin{align*}
	\dfrac{d}{dt}\left(\dfrac{\partial L}{\partial \dot{q_j}}\right) - \dfrac{\partial L}{\partial q_j} &amp;= Q_j
\end{align*}\]
<p>In the direction of x,</p>
\[\begin{align*}
	\dfrac{d}{dt}\left(\dfrac{\partial (0.5m(\dot{x}^2+\dot{y}^2 )-mgy)}{\partial \dot{x}}\right) - \dfrac{\partial (0.5m(\dot{x}^2+\dot{y}^2 )-mgy)}{\partial x} &amp;= -C\dot{x}\sqrt{\dot{x}^2+\dot{y}^2}\\
	\ddot{x} &amp;= -\dfrac{C}{m}\dot{x}\sqrt{\dot{x}^2+\dot{y}^2}
\end{align*}\]
<p>In the direction of y,</p>
\[\begin{align*}
	\dfrac{d}{dt}\left(\dfrac{\partial (0.5m(\dot{x}^2+\dot{y}^2 )-mgy)}{\partial \dot{y}}\right) - \dfrac{\partial (0.5m(\dot{x}^2+\dot{y}^2 )-mgy)}{\partial y} &amp;= -C\dot{y}\sqrt{\dot{x}^2+\dot{y}^2}\\
	\ddot{y} &amp;= -g -\dfrac{C}{m}\dot{y}\sqrt{\dot{x}^2+\dot{y}^2}
\end{align*}\]
<p>Integrating $\ddot{x}$ and $\ddot{y}$ $\textit{wrt}$ time should give us $\dot{x},\dot{y},x,y$.
<img src="/assets/img/2DRobotics/ProjNoD.png" alt="Image1" class="shadow" />
<img src="/assets/img/2DRobotics/ProjWiD.png" alt="Image1" class="shadow" /></p>
     </div>
     <div class="post-tail-wrapper text-muted">
       <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
            <a href='/categories/resources/'>Resources</a>,
            <a href='/categories/robotics-theory/'>Robotics Theory</a>
       </div>
       <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          <a href="/tags/matlab/"
            class="post-tag no-text-decoration" >matlab</a>
          <a href="/tags/manipulator/"
            class="post-tag no-text-decoration" >manipulator</a>
          <a href="/tags/differential-drive/"
            class="post-tag no-text-decoration" >differential drive</a>
          <a href="/tags/projectile-motion/"
            class="post-tag no-text-decoration" >projectile motion</a>
         </div>
       <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
         <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
         </div>
<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
        <a href="https://twitter.com/intent/tweet?text=Robotics Theory - 2D Robotics - Jai Krishna&url=https://textzip.github.io/posts/Robotics-Theory-2D-Robotics/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
        <a href="https://www.facebook.com/sharer/sharer.php?title=Robotics Theory - 2D Robotics - Jai Krishna&u=https://textzip.github.io/posts/Robotics-Theory-2D-Robotics/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
        <a href="https://telegram.me/share?text=Robotics Theory - 2D Robotics - Jai Krishna&url=https://textzip.github.io/posts/Robotics-Theory-2D-Robotics/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>
  </span>
</div>
       </div>
     </div>
   </div>
 </div>
<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">
 <div class="access">
   <div id="access-lastmod" class="post">
      <span>Recent Update</span>
     <ul class="post-content pl-0 pb-1 ml-1 mt-2">
       <li><a href="/posts/Loco-DRL/">Proprioceptive Locomotion in Unstructured Environments</a>
       <li><a href="/posts/FTG-DRL/">Policy Modulated Trajectory Generation for Quadrupeds</a>
       <li><a href="/posts/NST-DRL/">Neural Style Transfer for Locomotion</a>
       <li><a href="/posts/LIDAR-DRL/">Locomotion with Weighted Belief in Exteroception</a>
       <li><a href="/posts/BiMan-DRL/">Bi-Manual Loco-Manipulation in Quadrupeds for Opening Doors</a>
     </ul>
   </div>
   <div id="access-tags">
      <span>Trending Tags</span>
     <div class="d-flex flex-wrap mt-3 mb-1 mr-3">
        <a class="post-tag" href="/tags/atmega328p/">atmega328p</a>
        <a class="post-tag" href="/tags/imu/">imu</a>
        <a class="post-tag" href="/tags/game/">game</a>
        <a class="post-tag" href="/tags/reinforcement-learning/">reinforcement learning</a>
        <a class="post-tag" href="/tags/bellman/">bellman</a>
        <a class="post-tag" href="/tags/mdp/">mdp</a>
        <a class="post-tag" href="/tags/optimal-value/">optimal value</a>
        <a class="post-tag" href="/tags/touch/">touch</a>
        <a class="post-tag" href="/tags/quadruped/">quadruped</a>
        <a class="post-tag" href="/tags/ros/">ros</a>
     </div>
   </div>
 </div>
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
   <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
     <nav id="toc" data-toggle="toc"></nav>
   </div>
</div>
</div>
<div class="row">
 <div class="col-12 col-lg-11 col-xl-8">
   <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
 <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
   <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
   <div class="card-deck mb-4">
     <div class="card">
        <a href="/posts/Manipulator-Workspace-Plotter/">
         <div class="card-body">
<em class="timeago small"
    data-ts="1621361540"
    >
  2021-05-18
</em>
           <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Manipulator Workspace Plotter</h3>
           <div class="text-muted small">
             <p>
                Introduction
I wrote this small script to tinker with DH Parameters and wanted to visualize and understand how joint limits affect the manipulator workspace. While there are many ways of generating...
             </p>
           </div>
         </div>
        </a>
     </div>
     <div class="card">
        <a href="/posts/ROS-URDF/">
         <div class="card-body">
<em class="timeago small"
    data-ts="1641131000"
    >
  2022-01-02
</em>
           <h3 class="pt-0 mt-1 mb-3" data-toc-skip>URDF</h3>
           <div class="text-muted small">
             <p>
The URDF file format is a way to represent robots and their components in ROS. It uses a modified verion of the XML syntax.
Structure of URDF
geometry types
box
1
&lt;box size="0.6 0.1 0.2...
             </p>
           </div>
         </div>
        </a>
     </div>
     <div class="card">
        <a href="/posts/DRL-0/">
         <div class="card-body">
<em class="timeago small"
    data-ts="1674027800"
    >
  2023-01-18
</em>
           <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Deep Reinforcement Learning - Part 0 - Getting Started</h3>
           <div class="text-muted small">
             <p>
                Getting into deep reinforcement learning is a tough but rewarding journey. The primary reason it is so difficult for beginners is due to the shear number of fields involved. Deep Reinforcement Lear...
             </p>
           </div>
         </div>
        </a>
     </div>
   </div>
 </div>
<div class="post-navigation d-flex justify-content-between">
  <a href="/posts/AVR-Diaries-03-Timers/" class="btn btn-outline-primary"
    prompt="Older">
   <p>Hands On with AVR - 03 Timers</p>
  </a>
  <a href="/posts/AVR-Diaries-02-Interrupts/" class="btn btn-outline-primary"
    prompt="Newer">
   <p>Hands On with AVR - 02 Interrupts</p>
  </a>
</div>
    <script src="https://utteranc.es/client.js"
        repo="TextZip/textzip.github.io"
        issue-term="title"
        theme="dark-blue"
        crossorigin="anonymous"
        async>
    </script>
   </div>
 </div>
</div>
<footer class="d-flex w-100 justify-content-center">
 <div class="d-flex justify-content-between align-items-center">
   <div class="footer-left">
     <p class="mb-0">
        © 2025
        <a href="https://github.com/TextZip">Bandi Jai Krishna</a>.
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
     </p>
   </div>
   <div class="footer-right">
     <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
     </p>
   </div>
 </div>
</footer>
     </div>
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
 <div class="col-12 col-sm-11 post-content">
   <div id="search-hints">
     <h4 class="text-muted mb-4">Trending Tags</h4>
        <a class="post-tag" href="/tags/atmega328p/">atmega328p</a>
        <a class="post-tag" href="/tags/imu/">imu</a>
        <a class="post-tag" href="/tags/game/">game</a>
        <a class="post-tag" href="/tags/reinforcement-learning/">reinforcement learning</a>
        <a class="post-tag" href="/tags/bellman/">bellman</a>
        <a class="post-tag" href="/tags/mdp/">mdp</a>
        <a class="post-tag" href="/tags/optimal-value/">optimal value</a>
        <a class="post-tag" href="/tags/touch/">touch</a>
        <a class="post-tag" href="/tags/quadruped/">quadruped</a>
        <a class="post-tag" href="/tags/ros/">ros</a>
   </div>
   <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
 </div>
</div>
   </div>
   <div id="mask"></div>
    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>
<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>
<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="https://textzip.github.io{url}">{title}</a> <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags} </div><p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }
    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>
  
